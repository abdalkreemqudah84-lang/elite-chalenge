<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿßŸÑŸÑÿπÿ®ÿ© - ÿ™ÿ≠ÿØŸä ÿßŸÑŸÜÿÆÿ®ÿ©</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===== RESET ===== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Cairo', sans-serif; 
            background: linear-gradient(135deg, #0c2461 0%, #1e3799 100%); 
            color: white; 
            min-height: 100vh;
        }
        
        /* ===== NAVBAR ===== */
        .navbar {
            background: rgba(10, 25, 47, 0.95);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid #00d4ff;
        }
        
        .nav-container {
            max-width: 1300px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.8rem;
            color: #00d4ff;
            text-decoration: none;
        }
        
        .logo i {
            font-size: 2.2rem;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 50px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-link:hover, .nav-link.active {
            background: #00d4ff;
            color: black;
        }
        
        /* ===== MAIN GAME CONTAINER ===== */
        .game-container {
            max-width: 1200px;
            margin: 100px auto 40px;
            padding: 0 30px;
            min-height: calc(100vh - 140px);
            display: flex;
            flex-direction: column;
        }
        
        /* ===== GAME HEADER ===== */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .game-title {
            font-size: 2.5rem;
            color: #00d4ff;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .game-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .info-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            min-width: 120px;
            border: 1px solid rgba(0, 212, 255, 0.2);
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00d4ff;
        }
        
        /* ===== GAME CONTENT ===== */
        .game-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
            flex: 1;
        }
        
        /* ===== QUESTION CONTAINER ===== */
        .question-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 25px;
            border: 2px solid rgba(0, 212, 255, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .category-badge {
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            color: black;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .timer-container {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }
        
        .timer {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #00d4ff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #00d4ff;
        }
        
        .question-text {
            font-size: 1.8rem;
            line-height: 1.6;
            margin-bottom: 40px;
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border-right: 5px solid #00d4ff;
        }
        
        /* ===== OPTIONS CONTAINER ===== */
        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .option-btn {
            padding: 25px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: right;
            position: relative;
            overflow: hidden;
        }
        
        .option-btn:hover {
            background: rgba(0, 212, 255, 0.2);
            transform: translateY(-5px);
            border-color: #00d4ff;
        }
        
        .option-btn.correct {
            background: rgba(0, 230, 118, 0.3);
            border-color: #00e676;
            color: #00e676;
        }
        
        .option-btn.wrong {
            background: rgba(255, 71, 87, 0.3);
            border-color: #ff4757;
            color: #ff4757;
        }
        
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .option-number {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* ===== GAME CONTROLS ===== */
        .game-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-top: 2px solid rgba(0, 212, 255, 0.3);
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .progress-container {
            flex: 1;
            max-width: 400px;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #0099ff);
            border-radius: 5px;
            transition: width 0.3s;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: #aaa;
        }
        
        .control-buttons {
            display: flex;
            gap: 15px;
        }
        
        .control-btn {
            padding: 12px 25px;
            border-radius: 10px;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            color: black;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(0, 212, 255, 0.4);
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
        }
        
        /* ===== FEEDBACK MESSAGE ===== */
        .feedback-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid;
            z-index: 10000;
            text-align: center;
            min-width: 300px;
            max-width: 500px;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .feedback-message.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .feedback-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .feedback-text {
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .feedback-correct {
            border-color: #00e676;
        }
        
        .feedback-wrong {
            border-color: #ff4757;
        }
        
        /* ===== GAME OVER MODAL ===== */
        .game-over-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }
        
        .game-over-modal.show {
            display: flex;
        }
        
        .game-over-content {
            background: linear-gradient(145deg, #0c2461, #1e3799);
            padding: 50px;
            border-radius: 25px;
            width: 90%;
            max-width: 600px;
            border: 3px solid #00d4ff;
            text-align: center;
            box-shadow: 0 25px 60px rgba(0, 212, 255, 0.4);
        }
        
        .game-over-icon {
            font-size: 5rem;
            color: #00d4ff;
            margin-bottom: 20px;
        }
        
        .game-over-title {
            font-size: 2.5rem;
            color: #00d4ff;
            margin-bottom: 20px;
        }
        
        .game-over-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(0, 212, 255, 0.2);
        }
        
        .stat-value {
            font-size: 2rem;
            color: #00d4ff;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #aaa;
            font-size: 0.9rem;
        }
        
        .game-over-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        /* ===== CATEGORY SELECTION ===== */
        .category-selection {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid rgba(0, 212, 255, 0.3);
            margin-bottom: 30px;
            display: none;
        }
        
        .category-selection.show {
            display: block;
        }
        
        .category-title {
            font-size: 1.5rem;
            color: #00d4ff;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .category-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            border: 2px solid transparent;
        }
        
        .category-item:hover {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
            transform: translateY(-5px);
        }
        
        .category-item i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #00d4ff;
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .game-container {
                margin-top: 150px;
                padding: 0 20px;
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
            
            .question-text {
                font-size: 1.4rem;
            }
            
            .options-container {
                grid-template-columns: 1fr;
            }
            
            .game-controls {
                flex-direction: column;
            }
            
            .progress-container {
                width: 100%;
                max-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .game-title {
                font-size: 1.8rem;
            }
            
            .info-box {
                min-width: 100px;
                padding: 10px 15px;
            }
            
            .question-container {
                padding: 20px;
            }
            
            .game-over-content {
                padding: 30px 20px;
            }
            
            .game-over-stats {
                grid-template-columns: 1fr;
            }
        }
        
        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- ===== NAVBAR ===== -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-crown"></i>
                <span>ÿ™ÿ≠ÿØŸä ÿßŸÑŸÜÿÆÿ®ÿ©</span>
            </a>
            
            <div class="nav-links">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i> ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                </a>
                <a href="game.html" class="nav-link active">
                    <i class="fas fa-gamepad"></i> ÿßŸÑŸÑÿπÿ®ÿ©
                </a>
                <a href="setup.html" class="nav-link">
                    <i class="fas fa-cog"></i> ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                </a>
                <a href="#" class="nav-link" onclick="endGame()">
                    <i class="fas fa-stop-circle"></i> ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÑÿπÿ®ÿ©
                </a>
            </div>
        </div>
    </nav>

    <!-- ===== GAME CONTAINER ===== -->
    <div class="game-container">
        <!-- Game Header -->
        <div class="game-header">
            <h1 class="game-title">
                <i class="fas fa-brain"></i> ÿ™ÿ≠ÿØŸä ÿßŸÑŸÜÿÆÿ®ÿ©
            </h1>
            
            <div class="game-info">
                <div class="info-box">
                    <div class="info-label">ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©</div>
                    <div class="info-value" id="scoreValue">0</div>
                </div>
                <div class="info-box">
                    <div class="info-label">ÿßŸÑŸàŸÇÿ™</div>
                    <div class="info-value" id="timerValue">30</div>
                </div>
                <div class="info-box">
                    <div class="info-label">ÿßŸÑÿ≥ÿ§ÿßŸÑ</div>
                    <div class="info-value">
                        <span id="currentQuestion">1</span>/<span id="totalQuestions">10</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Category Selection (Visible at Start) -->
        <div class="category-selection show" id="categorySelection">
            <h2 class="category-title">
                <i class="fas fa-layer-group"></i> ÿßÿÆÿ™ÿ± ŸÅÿ¶ÿ© ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©
            </h2>
            <div class="categories-grid" id="categoriesGrid">
                <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿá ÿ®ÿßŸÑÿ¨ÿßŸÅÿßÿ≥ŸÉÿ±Ÿäÿ®ÿ™ -->
            </div>
        </div>

        <!-- Game Content -->
        <div class="game-content" id="gameContent" style="display: none;">
            <!-- Question Container -->
            <div class="question-container">
                <div class="question-header">
                    <div class="category-badge" id="currentCategory">
                        <i class="fas fa-tag"></i>
                        <span id="categoryName">ÿßŸÑÿπŸÑŸàŸÖ</span>
                    </div>
                    
                    <div class="timer-container">
                        <i class="fas fa-clock"></i>
                        <div class="timer" id="timerCircle">30</div>
                        <span>ÿ´ÿßŸÜŸäÿ©</span>
                    </div>
                </div>
                
                <div class="question-text" id="questionText">
                    ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ≥ÿ§ÿßŸÑ...
                </div>
                
                <div class="options-container" id="optionsContainer">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿá ÿ®ÿßŸÑÿ¨ÿßŸÅÿßÿ≥ŸÉÿ±Ÿäÿ®ÿ™ -->
                </div>
            </div>

            <!-- Game Controls -->
            <div class="game-controls">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 10%;"></div>
                    </div>
                    <div class="progress-text">
                        ÿ™ŸÇÿØŸÖ: <span id="progressText">1/10</span>
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="control-btn btn-secondary" onclick="skipQuestion()">
                        <i class="fas fa-forward"></i> ÿ™ÿÆÿ∑Ÿä
                    </button>
                    <button class="control-btn btn-primary" onclick="nextQuestion()" id="nextButton" style="display: none;">
                        <i class="fas fa-arrow-right"></i> ÿßŸÑÿ™ÿßŸÑŸä
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== MODALS ===== -->
    
    <!-- Feedback Message -->
    <div class="feedback-message" id="feedbackMessage">
        <div class="feedback-icon" id="feedbackIcon"></div>
        <div class="feedback-text" id="feedbackText"></div>
        <button class="control-btn btn-primary" onclick="hideFeedback()">
            <i class="fas fa-arrow-right"></i> ŸÖÿ™ÿßÿ®ÿπÿ©
        </button>
    </div>

    <!-- Game Over Modal -->
    <div class="game-over-modal" id="gameOverModal">
        <div class="game-over-content">
            <div class="game-over-icon">
                <i class="fas fa-trophy"></i>
            </div>
            
            <h2 class="game-over-title">üéâ ÿ•ŸÜÿ™Ÿáÿ™ ÿßŸÑŸÑÿπÿ®ÿ©!</h2>
            
            <div class="game-over-stats">
                <div class="stat-box">
                    <div class="stat-value" id="finalScore">0</div>
                    <div class="stat-label">ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">ÿ•ÿ¨ÿßÿ®ÿßÿ™ ÿµÿ≠Ÿäÿ≠ÿ©</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="totalTime">0</div>
                    <div class="stat-label">ÿ´ÿßŸÜŸäÿ©</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">ÿØŸÇÿ© ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™</div>
                </div>
            </div>
            
            <div class="game-over-actions">
                <button class="control-btn btn-primary" onclick="playAgain()">
                    <i class="fas fa-redo"></i> ŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ
                </button>
                <button class="control-btn btn-secondary" onclick="goToSetup()">
                    <i class="fas fa-cog"></i> ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                </button>
                <button class="control-btn btn-secondary" onclick="goToHome()">
                    <i class="fas fa-home"></i> ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                </button>
            </div>
        </div>
    </div>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // ===== GAME STATE =====
        let gameState = {
            score: 0,
            currentQuestionIndex: 0,
            totalQuestions: 10,
            timeLeft: 30,
            timerInterval: null,
            selectedCategory: null,
            questions: [],
            answeredQuestions: 0,
            correctAnswers: 0,
            startTime: null,
            gameActive: false
        };
        
        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéÆ ÿµŸÅÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿ¨ÿßŸáÿ≤ÿ©');
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
            loadUserData();
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            loadGameSettings();
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÅÿ¶ÿßÿ™
            loadCategories();
            
            // ÿ•ÿπÿØÿßÿØ event listeners
            setupEventListeners();
        });
        
        // ===== LOAD USER DATA =====
        function loadUserData() {
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            
            if (!user.email) {
                // ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖÿ≥ÿ¨ŸÑ ÿØÿÆŸàŸÑ
                alert('‚ùå Ÿäÿ¨ÿ® ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ£ŸàŸÑÿßŸã');
                window.location.href = 'index.html';
                return;
            }
            
            console.log('üë§ ŸÑÿßÿπÿ®:', user.name || 'ŸÖÿ¨ŸáŸàŸÑ');
        }
        
        // ===== LOAD GAME SETTINGS =====
        function loadGameSettings() {
            const config = JSON.parse(localStorage.getItem('gameConfig') || '{}');
            const settings = JSON.parse(localStorage.getItem('gameSettings') || '{}');
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            if (config.timePerQuestion) {
                gameState.timeLeft = config.timePerQuestion;
                document.getElementById('timerValue').textContent = config.timePerQuestion;
                document.getElementById('timerCircle').textContent = config.timePerQuestion;
            }
            
            if (config.totalQuestions) {
                gameState.totalQuestions = config.totalQuestions;
                document.getElementById('totalQuestions').textContent = config.totalQuestions;
                updateProgress();
            }
            
            console.log('‚öôÔ∏è ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©:', config);
        }
        
        // ===== LOAD CATEGORIES =====
        function loadCategories() {
            const categories = [
                { id: 'science', name: 'üî¨ ÿßŸÑÿπŸÑŸàŸÖ', icon: 'flask', color: '#00e676' },
                { id: 'history', name: 'üèõÔ∏è ÿßŸÑÿ™ÿßÿ±ŸäÿÆ', icon: 'landmark', color: '#ffa726' },
                { id: 'geography', name: 'üåç ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸäÿß', icon: 'globe-asia', color: '#29b6f6' },
                { id: 'sports', name: '‚öΩ ÿßŸÑÿ±Ÿäÿßÿ∂ÿ©', icon: 'futbol', color: '#ff5252' },
                { id: 'art', name: 'üé® ÿßŸÑŸÅŸÜ', icon: 'palette', color: '#ab47bc' },
                { id: 'technology', name: 'üíª ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß', icon: 'laptop-code', color: '#7e57c2' },
                { id: 'random', name: 'üé≤ ÿπÿ¥Ÿàÿßÿ¶Ÿä', icon: 'random', color: '#00d4ff' }
            ];
            
            const grid = document.getElementById('categoriesGrid');
            grid.innerHTML = '';
            
            categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.innerHTML = `
                    <i class="fas fa-${category.icon}"></i>
                    <div>${category.name}</div>
                `;
                categoryItem.onclick = () => selectCategory(category);
                grid.appendChild(categoryItem);
            });
        }
        
        // ===== SELECT CATEGORY =====
        function selectCategory(category) {
            gameState.selectedCategory = category;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
            document.getElementById('categorySelection').classList.remove('show');
            document.getElementById('gameContent').style.display = 'flex';
            document.getElementById('categoryName').textContent = category.name;
            
            // ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©
            startGame();
        }
        
        // ===== START GAME =====
        function startGame() {
            gameState.startTime = new Date();
            gameState.gameActive = true;
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©
            loadQuestions();
            
            // ÿπÿ±ÿ∂ ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ£ŸàŸÑ
            displayQuestion();
            
            // ÿ®ÿØÿ° ÿßŸÑŸÖÿ§ŸÇÿ™
            startTimer();
        }
        
        // ===== LOAD QUESTIONS =====
        function loadQuestions() {
            // ŸÅŸä ÿßŸÑŸàÿßŸÇÿπÿå Ÿáÿ∞Ÿá ÿßŸÑÿØÿßŸÑÿ© ÿ≥ÿ™ÿ≥ÿ™ÿØÿπŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            // ŸÑŸÉŸÜ ŸÑÿ£ÿ∫ÿ±ÿßÿ∂ ÿßŸÑÿπÿ±ÿ∂ÿå ÿ≥ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
            
            const allQuestions = {
                science: [
                    {
                        question: "ŸÖÿß ŸáŸà ÿßŸÑÿπŸÜÿµÿ± ÿßŸÑÿ£ŸÉÿ´ÿ± ŸàŸÅÿ±ÿ© ŸÅŸä ÿßŸÑŸÉŸàŸÜÿü",
                        options: ["ÿßŸÑŸáŸäÿØÿ±Ÿàÿ¨ŸäŸÜ", "ÿßŸÑÿ£ŸÉÿ≥ÿ¨ŸäŸÜ", "ÿßŸÑŸÉÿ±ÿ®ŸàŸÜ", "ÿßŸÑÿ≠ÿØŸäÿØ"],
                        correct: 0,
                        explanation: "ÿßŸÑŸáŸäÿØÿ±Ÿàÿ¨ŸäŸÜ ŸáŸà ÿßŸÑÿπŸÜÿµÿ± ÿßŸÑÿ£ŸÉÿ´ÿ± ŸàŸÅÿ±ÿ© ŸÅŸä ÿßŸÑŸÉŸàŸÜ"
                    },
                    {
                        question: "ŸÉŸÖ ÿπÿØÿØ ÿßŸÑÿπÿ∏ÿßŸÖ ŸÅŸä ÿ¨ÿ≥ŸÖ ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ÿßŸÑÿ®ÿßŸÑÿ∫ÿü",
                        options: ["206", "300", "150", "250"],
                        correct: 0,
                        explanation: "Ÿäÿ≠ÿ™ŸàŸä ÿ¨ÿ≥ŸÖ ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ÿßŸÑÿ®ÿßŸÑÿ∫ ÿπŸÑŸâ 206 ÿπÿ∏ŸÖÿ©"
                    }
                ],
                history: [
                    {
                        question: "ŸÖÿ™Ÿâ ŸàŸÇÿπÿ™ ÿßŸÑÿ≠ÿ±ÿ® ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ÿßŸÑÿ£ŸàŸÑŸâÿü",
                        options: ["1914-1918", "1939-1945", "1900-1910", "1920-1930"],
                        correct: 0,
                        explanation: "ŸàŸÇÿπÿ™ ÿßŸÑÿ≠ÿ±ÿ® ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ÿßŸÑÿ£ŸàŸÑŸâ ÿ®ŸäŸÜ ÿπÿßŸÖŸä 1914 Ÿà1918"
                    },
                    {
                        question: "ŸÖŸÜ ŸáŸà ÿ£ŸàŸÑ ÿ±ÿ¶Ÿäÿ≥ ŸÑŸÑŸàŸÑÿßŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿØÿ© ÿßŸÑÿ£ŸÖÿ±ŸäŸÉŸäÿ©ÿü",
                        options: ["ÿ¨Ÿàÿ±ÿ¨ Ÿàÿßÿ¥ŸÜÿ∑ŸÜ", "ÿ£ÿ®ÿ±ÿßŸáÿßŸÖ ŸÑŸäŸÜŸÉŸàŸÑŸÜ", "ÿ™ŸàŸÖÿßÿ≥ ÿ¨ŸäŸÅÿ±ÿ≥ŸàŸÜ", "ÿ¨ŸàŸÜ ÿ¢ÿØŸÖÿ≤"],
                        correct: 0,
                        explanation: "ÿ¨Ÿàÿ±ÿ¨ Ÿàÿßÿ¥ŸÜÿ∑ŸÜ ŸáŸà ÿ£ŸàŸÑ ÿ±ÿ¶Ÿäÿ≥ ŸÑŸÑŸàŸÑÿßŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿØÿ©"
                    }
                ],
                geography: [
                    {
                        question: "ŸÖÿß ŸáŸä ÿ£ŸÉÿ®ÿ± ŸÇÿßÿ±ÿ© ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖÿü",
                        options: ["ÿ¢ÿ≥Ÿäÿß", "ÿ£ŸÅÿ±ŸäŸÇŸäÿß", "ÿ£Ÿàÿ±Ÿàÿ®ÿß", "ÿ£ŸÖÿ±ŸäŸÉÿß ÿßŸÑÿ¥ŸÖÿßŸÑŸäÿ©"],
                        correct: 0,
                        explanation: "ÿ¢ÿ≥Ÿäÿß ŸáŸä ÿ£ŸÉÿ®ÿ± ŸÇÿßÿ±ÿ© ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖ"
                    },
                    {
                        question: "ŸÖÿß ŸáŸä ÿ£ÿ∑ŸàŸÑ ŸÜŸáÿ± ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖÿü",
                        options: ["ŸÜŸáÿ± ÿßŸÑŸÜŸäŸÑ", "ŸÜŸáÿ± ÿßŸÑÿ£ŸÖÿßÿ≤ŸàŸÜ", "ŸÜŸáÿ± ÿßŸÑŸäÿßŸÜÿ∫ÿ™ÿ≥Ÿä", "ŸÜŸáÿ± ÿßŸÑŸÖÿ≥Ÿäÿ≥Ÿäÿ®Ÿä"],
                        correct: 0,
                        explanation: "ŸÜŸáÿ± ÿßŸÑŸÜŸäŸÑ ŸáŸà ÿ£ÿ∑ŸàŸÑ ŸÜŸáÿ± ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖ"
                    }
                ],
                sports: [
                    {
                        question: "ŸÉŸÖ ŸÑÿßÿπÿ® ŸÅŸä ŸÅÿ±ŸäŸÇ ŸÉÿ±ÿ© ÿßŸÑŸÇÿØŸÖÿü",
                        options: ["11", "10", "9", "12"],
                        correct: 0,
                        explanation: "Ÿäÿ™ŸÉŸàŸÜ ŸÅÿ±ŸäŸÇ ŸÉÿ±ÿ© ÿßŸÑŸÇÿØŸÖ ŸÖŸÜ 11 ŸÑÿßÿπÿ®"
                    },
                    {
                        question: "ŸÖŸÜ ŸÅÿßÿ≤ ÿ®ŸÉÿ£ÿ≥ ÿßŸÑÿπÿßŸÑŸÖ 2022ÿü",
                        options: ["ÿßŸÑÿ£ÿ±ÿ¨ŸÜÿ™ŸäŸÜ", "ŸÅÿ±ŸÜÿ≥ÿß", "ÿßŸÑÿ®ÿ±ÿßÿ≤ŸäŸÑ", "ÿ£ŸÑŸÖÿßŸÜŸäÿß"],
                        correct: 0,
                        explanation: "ŸÅÿßÿ≤ÿ™ ÿßŸÑÿ£ÿ±ÿ¨ŸÜÿ™ŸäŸÜ ÿ®ŸÉÿ£ÿ≥ ÿßŸÑÿπÿßŸÑŸÖ 2022"
                    }
                ],
                art: [
                    {
                        question: "ŸÖŸÜ ÿ±ÿ≥ŸÖ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸàŸÜÿßŸÑŸäÿ≤ÿßÿü",
                        options: ["ŸÑŸäŸàŸÜÿßÿ±ÿØŸà ÿØÿßŸÅŸÜÿ¥Ÿä", "ŸÅÿßŸÜ ÿ¨ŸàÿÆ", "ÿ®ŸäŸÉÿßÿ≥Ÿà", "ŸÖŸäŸÉŸäŸÑÿßŸÜÿ¨ŸäŸÑŸà"],
                        correct: 0,
                        explanation: "ŸÑŸäŸàŸÜÿßÿ±ÿØŸà ÿØÿßŸÅŸÜÿ¥Ÿä ŸáŸà ÿ±ÿ≥ÿßŸÖ ÿßŸÑŸÖŸàŸÜÿßŸÑŸäÿ≤ÿß"
                    },
                    {
                        question: "ŸÖÿß ŸáŸä ÿ¨ŸÜÿ≥Ÿäÿ© ÿßŸÑÿ±ÿ≥ÿßŸÖ ŸÅÿßŸÜ ÿ¨ŸàÿÆÿü",
                        options: ["ŸáŸàŸÑŸÜÿØŸä", "ŸÅÿ±ŸÜÿ≥Ÿä", "ÿ•Ÿäÿ∑ÿßŸÑŸä", "ÿ•ÿ≥ÿ®ÿßŸÜŸä"],
                        correct: 0,
                        explanation: "ŸÅÿßŸÜ ÿ¨ŸàÿÆ ŸáŸà ÿ±ÿ≥ÿßŸÖ ŸáŸàŸÑŸÜÿØŸä"
                    }
                ],
                technology: [
                    {
                        question: "ŸÖÿß ŸáŸä ŸÑÿ∫ÿ© ÿßŸÑÿ®ÿ±ŸÖÿ¨ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖÿ© ŸÅŸä ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸàŸäÿ®ÿü",
                        options: ["JavaScript", "Python", "Java", "C++"],
                        correct: 0,
                        explanation: "JavaScript ŸáŸä ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸÑÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸàŸäÿ®"
                    },
                    {
                        question: "ŸÖŸÜ ŸÖÿ§ÿ≥ÿ≥ ÿ¥ÿ±ŸÉÿ© ŸÖÿßŸäŸÉÿ±Ÿàÿ≥ŸàŸÅÿ™ÿü",
                        options: ["ÿ®ŸäŸÑ ÿ∫Ÿäÿ™ÿ≥", "ÿ≥ÿ™ŸäŸÅ ÿ¨Ÿàÿ®ÿ≤", "ŸÖÿßÿ±ŸÉ ÿ≤ŸàŸÉÿ±ÿ®Ÿäÿ±ÿ∫", "ŸÑÿßÿ±Ÿä ÿ®Ÿäÿ¨"],
                        correct: 0,
                        explanation: "ÿ®ŸäŸÑ ÿ∫Ÿäÿ™ÿ≥ ŸáŸà ŸÖÿ§ÿ≥ÿ≥ ÿ¥ÿ±ŸÉÿ© ŸÖÿßŸäŸÉÿ±Ÿàÿ≥ŸàŸÅÿ™"
                    }
                ]
            };
            
            // ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸÅÿ¶ÿ©
            if (gameState.selectedCategory.id === 'random') {
                // ÿØŸÖÿ¨ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©
                gameState.questions = [];
                for (const cat in allQuestions) {
                    gameState.questions = gameState.questions.concat(allQuestions[cat]);
                }
            } else {
                gameState.questions = allQuestions[gameState.selectedCategory.id] || allQuestions.science;
            }
            
            // ÿ™ÿ≠ÿØŸäÿØ ÿπÿØÿØ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©
            if (gameState.questions.length > gameState.totalQuestions) {
                gameState.questions = shuffleArray(gameState.questions).slice(0, gameState.totalQuestions);
            }
            
            console.log(`üìö ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ${gameState.questions.length} ÿ≥ÿ§ÿßŸÑ`);
        }
        
        // ===== DISPLAY QUESTION =====
        function displayQuestion() {
            if (gameState.currentQuestionIndex >= gameState.questions.length) {
                endGame();
                return;
            }
            
            const question = gameState.questions[gameState.currentQuestionIndex];
            
            // ÿπÿ±ÿ∂ ŸÜÿµ ÿßŸÑÿ≥ÿ§ÿßŸÑ
            document.getElementById('questionText').textContent = question.question;
            
            // ÿπÿ±ÿ∂ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.innerHTML = `
                    <div class="option-number">${index + 1}</div>
                    ${option}
                `;
                button.onclick = () => checkAnswer(index);
                optionsContainer.appendChild(button);
            });
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÖÿ§ŸÇÿ™
            resetTimer();
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÇÿØŸÖ
            updateProgress();
            
            // ÿ•ÿÆŸÅÿßÿ° ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
            document.getElementById('nextButton').style.display = 'none';
        }
        
        // ===== CHECK ANSWER =====
        function checkAnswer(selectedIndex) {
            if (!gameState.gameActive) return;
            
            const question = gameState.questions[gameState.currentQuestionIndex];
            const isCorrect = selectedIndex === question.correct;
            
            // ÿ™ÿπÿ∑ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
            });
            
            // ÿ™ŸÑŸàŸäŸÜ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿßÿ™
            document.querySelectorAll('.option-btn').forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.add('correct');
                } else if (index === selectedIndex && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©
            if (isCorrect) {
                gameState.score += 10;
                gameState.correctAnswers++;
                document.getElementById('scoreValue').textContent = gameState.score;
                showFeedback(true, "‚úÖ ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©!", question.explanation);
            } else {
                showFeedback(false, "‚ùå ÿ•ÿ¨ÿßÿ®ÿ© ÿÆÿßÿ∑ÿ¶ÿ©!", question.explanation);
            }
            
            gameState.answeredQuestions++;
            
            // ÿ•ŸäŸÇÿßŸÅ ÿßŸÑŸÖÿ§ŸÇÿ™
            clearInterval(gameState.timerInterval);
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
            document.getElementById('nextButton').style.display = 'flex';
        }
        
        // ===== NEXT QUESTION =====
        function nextQuestion() {
            gameState.currentQuestionIndex++;
            displayQuestion();
        }
        
        // ===== SKIP QUESTION =====
        function skipQuestion() {
            if (!gameState.gameActive) return;
            
            showFeedback(false, "‚è≠Ô∏è ÿ™ŸÖ ÿ™ÿÆÿ∑Ÿä ÿßŸÑÿ≥ÿ§ÿßŸÑ", "ŸÑŸÖ ÿ™ÿ≠ÿµŸÑ ÿπŸÑŸâ ŸÜŸÇÿßÿ∑ ŸÑŸáÿ∞ÿß ÿßŸÑÿ≥ÿ§ÿßŸÑ");
            
            gameState.currentQuestionIndex++;
            setTimeout(() => {
                displayQuestion();
            }, 1500);
        }
        
        // ===== TIMER FUNCTIONS =====
        function startTimer() {
            resetTimer();
            gameState.timerInterval = setInterval(updateTimer, 1000);
        }
        
        function updateTimer() {
            gameState.timeLeft--;
            document.getElementById('timerValue').textContent = gameState.timeLeft;
            document.getElementById('timerCircle').textContent = gameState.timeLeft;
            
            if (gameState.timeLeft <= 10) {
                document.getElementById('timerCircle').style.color = '#ff4757';
                document.getElementById('timerCircle').classList.add('pulse');
            }
            
            if (gameState.timeLeft <= 0) {
                clearInterval(gameState.timerInterval);
                timeUp();
            }
        }
        
        function resetTimer() {
            const config = JSON.parse(localStorage.getItem('gameConfig') || '{}');
            gameState.timeLeft = config.timePerQuestion || 30;
            document.getElementById('timerValue').textContent = gameState.timeLeft;
            document.getElementById('timerCircle').textContent = gameState.timeLeft;
            document.getElementById('timerCircle').style.color = '#00d4ff';
            document.getElementById('timerCircle').classList.remove('pulse');
        }
        
        function timeUp() {
            if (!gameState.gameActive) return;
            
            showFeedback(false, "‚è∞ ÿßŸÜÿ™ŸáŸâ ÿßŸÑŸàŸÇÿ™!", "ŸÑŸÖ ÿ™ÿ™ŸÖŸÉŸÜ ŸÖŸÜ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ÿØÿØ");
            
            // ÿ™ÿπÿ∑ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
            });
            
            // ÿ™ŸÑŸàŸäŸÜ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©
            const question = gameState.questions[gameState.currentQuestionIndex];
            document.querySelectorAll('.option-btn').forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.add('correct');
                }
            });
            
            gameState.answeredQuestions++;
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä
            document.getElementById('nextButton').style.display = 'flex';
        }
        
        // ===== UPDATE PROGRESS =====
        function updateProgress() {
            const progress = ((gameState.currentQuestionIndex + 1) / gameState.totalQuestions) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = 
                `${gameState.currentQuestionIndex + 1}/${gameState.totalQuestions}`;
            document.getElementById('currentQuestion').textContent = gameState.currentQuestionIndex + 1;
        }
        
        // ===== FEEDBACK FUNCTIONS =====
        function showFeedback(isCorrect, message, explanation) {
            const feedback = document.getElementById('feedbackMessage');
            const icon = document.getElementById('feedbackIcon');
            const text = document.getElementById('feedbackText');
            
            if (isCorrect) {
                feedback.classList.add('feedback-correct');
                feedback.classList.remove('feedback-wrong');
                icon.innerHTML = '<i class="fas fa-check-circle"></i>';
                icon.style.color = '#00e676';
            } else {
                feedback.classList.add('feedback-wrong');
                feedback.classList.remove('feedback-correct');
                icon.innerHTML = '<i class="fas fa-times-circle"></i>';
                icon.style.color = '#ff4757';
            }
            
            text.innerHTML = `<div>${message}</div><div style="font-size: 1rem; color: #aaa; margin-top: 10px;">${explanation}</div>`;
            feedback.classList.add('show');
        }
        
        function hideFeedback() {
            document.getElementById('feedbackMessage').classList.remove('show');
            nextQuestion();
        }
        
        // ===== END GAME =====
        function endGame() {
            gameState.gameActive = false;
            clearInterval(gameState.timerInterval);
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸàŸÇÿ™ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
            const endTime = new Date();
            const totalTime = Math.floor((endTime - gameState.startTime) / 1000);
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿØŸÇÿ©
            const accuracy = gameState.answeredQuestions > 0 
                ? Math.round((gameState.correctAnswers / gameState.answeredQuestions) * 100) 
                : 0;
            
            // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('correctAnswers').textContent = `${gameState.correctAnswers}/${gameState.answeredQuestions}`;
            document.getElementById('totalTime').textContent = totalTime;
            document.getElementById('accuracy').textContent = `${accuracy}%`;
            
            // ÿ•ÿ∏Ÿáÿßÿ± ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
            document.getElementById('gameOverModal').classList.add('show');
            
            // ÿ≠ŸÅÿ∏ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
            saveGameResults(gameState.score, gameState.correctAnswers, totalTime, accuracy);
        }
        
        // ===== SAVE GAME RESULTS =====
        function saveGameResults(score, correct, time, accuracy) {
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const gameResults = {
                player: user.email,
                score: score,
                correctAnswers: correct,
                totalTime: time,
                accuracy: accuracy,
                category: gameState.selectedCategory?.name || 'ÿπÿ¥Ÿàÿßÿ¶Ÿä',
                date: new Date().toISOString()
            };
            
            // ÿ≠ŸÅÿ∏ ŸÅŸä localStorage
            const allResults = JSON.parse(localStorage.getItem('gameResults') || '[]');
            allResults.push(gameResults);
            localStorage.setItem('gameResults', JSON.stringify(allResults));
            
            console.log('üíæ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÑÿπÿ®ÿ©:', gameResults);
        }
        
        // ===== GAME OVER ACTIONS =====
        function playAgain() {
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿπÿ®ÿ©
            gameState = {
                score: 0,
                currentQuestionIndex: 0,
                totalQuestions: gameState.totalQuestions,
                timeLeft: 30,
                timerInterval: null,
                selectedCategory: gameState.selectedCategory,
                questions: [],
                answeredQuestions: 0,
                correctAnswers: 0,
                startTime: null,
                gameActive: false
            };
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
            document.getElementById('scoreValue').textContent = '0';
            document.getElementById('gameOverModal').classList.remove('show');
            document.getElementById('categorySelection').classList.add('show');
            document.getElementById('gameContent').style.display = 'none';
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©
            loadQuestions();
        }
        
        function goToSetup() {
            window.location.href = 'setup.html';
        }
        
        function goToHome() {
            window.location.href = 'index.html';
        }
        
        function endGame() {
            if (confirm('‚ö†Ô∏è ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÑÿπÿ®ÿ©ÿü')) {
                window.location.href = 'index.html';
            }
        }
        
        // ===== HELPER FUNCTIONS =====
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function setupEventListeners() {
            // ÿ•ÿ∂ÿßŸÅÿ© event listeners ÿ•ÿ∂ÿßŸÅŸäÿ© ŸáŸÜÿß ÿ•ÿ∞ÿß ŸÑÿ≤ŸÖ ÿßŸÑÿ£ŸÖÿ±
        }
    </script>
</body>
</html>